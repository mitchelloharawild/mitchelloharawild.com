{
  "hash": "50c498d2ee4a17b3f522abf6e1822495",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: useR! 2018 feature wall\ndescription: 'Creating the hexmap feature wall for useR! 2018'\nauthor: Mitchell O'Hara-Wild\ndate: '2018-07-11'\ncategories:\n  - magick\n  - useR!2018\ntags:\n  - conference\n  - hexagon\n  - sticker\n  - wall\n  - design\nimage: 'featurewall.png'\nimage-alt: 'Hex sticker feature wall'\nfreeze: true\n---\n\n\n\n\nThe hexwall at [useR! 2018](http://user2018.r-project.org/) features roughly 200 contributed R package hexagon stickers. If you've ever had difficulty aligning hexagon stickers in your slides or even on your laptop, you may appreciate the challenge of arranging hundreds of hexagons. Fortunately with R and a little bit of magick, we can substantially simplify this process.\n\n## Collection\n\nHexagon collection proved to be one of the more time-consuming steps in the project. Without a Comprehensive R Hexagon Repository (CRHR), Di Cook ([\\@visnut](https://twitter.com/visnut/)) and I resorted to collecting hexagons via email and promoting the project via twitter.\n\n\n{{< tweet visnut 999443177412030464 >}}\n\n\n\nOur collection efforts were also supported by Rstudio's [hex-stickers](http://github.com/rstudio/hex-stickers) and Bioconductor's [BiocStickers](https://github.com/Bioconductor/BiocStickers) repositories. We opted not to sift through the [hexb.in](http://hexb.in/) library as we wanted the feature wall to feature only R package stickers.\n\nThe response to our project has been huge, and we are grateful for everyone who has contributed their stickers.\n\n## hexwall\nThe hexwall script (available at [mitchelloharawild/hexwall](https://github.com/mitchelloharawild/hexwall)) provides the magick for cleaning, sorting, and arranging hexagons. The function does the following operations using the [ROpenSci magick package](https://github.com/ropensci/magick):\n\n* Load the images\n* Make white backgrounds transparent\n* Trim images\n* Remove bad images (low resolution or incorrect dimensions)\n* Arrange the stickers on the canvas\n\nFor more details on using magick to arrange hexagons, you can read [arranging hex stickers in R](https://blog.mitchelloharawild.com/blog/hexwall)\n\n## Creating the hex map\nTo create a hexagon map of Australia, we first need to find a map. I'm using the [GADM](https://gadm.org/) database to give a nice boundary of Australia, which is easily obtainable via the raster package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(raster)\nlibrary(sf)\naus <- getData(\"GADM\", country = \"AUS\", level = 0) %>%\n  disaggregate() %>%\n  geometry()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in getData(\"GADM\", country = \"AUS\", level = 0): getData will be removed in a future version of raster\n#> . Please use the geodata package instead\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning in explodePolygons(x, ...): No rgeos support in sp from October 2023;\n#> see https://r-spatial.org/r/2023/05/15/evolution4.html\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot() + \n  geom_sf(data = st_as_sf(aus))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/getAus-1.png){width=672}\n:::\n:::\n\n\nTo convert this map into hexagonal coordinates, we can use the `spsample` function to sample a hexagonal lattice. Through experimentation, a cellsize of 2 is roughly appropriate for the number of hexagons submitted to us. As it is a random process, some repetition may be needed to get the exact number of hexagons on the map with a nice layout.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhex_points <- aus %>%\n  spsample(type = \"hexagonal\", cellsize = 2)\n\nas_tibble(hex_points@coords)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 201 x 2\n#>        x     y\n#>    <dbl> <dbl>\n#>  1  146. -43.3\n#>  2  145. -41.6\n#>  3  147. -41.6\n#>  4  141. -38.1\n#>  5  143. -38.1\n#>  6  145. -38.1\n#>  7  147. -38.1\n#>  8  140. -36.4\n#>  9  142. -36.4\n#> 10  144. -36.4\n#> # i 191 more rows\n```\n\n\n:::\n:::\n\n\nTo ensure that we are happy with the hexagon placements, we should view the hexagon grid on a map. We can convert our coordinates to hexagonal polygons using `HexPoints2SpatialPolygons`, and then plot them on the map.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naus_hex <- HexPoints2SpatialPolygons(hex_points, dx = 2)\n\nggplot() + \n  geom_sf(data = st_as_sf(aus)) + \n  geom_sf(data = st_as_sf(aus_hex), colour = \"blue\", fill = NA)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/plotHex-1.png){width=672}\n:::\n:::\n\n\nLooks great, let's make the map. Using the script from [mitchelloharawild/hexwall](https://github.com/mitchelloharawild/hexwall), we provide:\n\n* A folder containing the hexagon images\n* Desired pixel width of each hexagon\n* Hexagon coordinates computed above\n\nIf there are lot of stickers to position, or the resulting image dimension is large, this may take some time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(\"hexwall.R\")\nhexwall(\n  \"hexstickers\",\n  sticker_width = 500,\n  coords = hex_points@coords,\n  sort_mode = \"colour\"\n)\n```\n:::\n\n![](final.jpg)\n\nBeyond that, there were just a few finishing touches needed to add the useR! 2018 logo and text. Hope you all enjoy the 2018 useR! conference :)",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}